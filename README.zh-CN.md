# EcoServer
### 面向 Paper 服务器的自适应性能控制引擎

> EcoServer 不是清理插件  
> 它是一个面向高负载服务器的自适应性能控制系统

[English Version](README.md)

---

## 🚀 项目愿景

大多数优化插件在 TPS 已经下降后才进行清理。

EcoServer 的目标不是“清理”，而是“控制”。

我们通过统一负载模型与状态引擎，
实现预测式、自适应的性能调节。

核心目标：

- 预防性能崩溃
- 减少不可见计算浪费
- 最大限度保护玩家体验
- 保持插件自身极低开销

---

# 🧠 核心模型 — LoadScore

LoadScore 是 EcoServer 的核心性能评分模型。

所有优化决策都围绕这一统一负载指数展开。

不同于单一阈值触发机制，
EcoServer 将多个运行指标整合为一个综合评分。

## 概念公式



LoadScore = α(TPS 偏移)
+ β(实体密度)
+ γ(区块活跃度)
+ δ(内存压力)
+ ε(玩家密度)


## 指标说明

**TPS 偏移**  
当前 TPS 与理想 20 TPS 的差值，并结合滑动平均趋势。

**实体密度**  
按类型加权统计实体数量（掉落物、生物、方块实体）。

**区块活跃度**  
当前加载且参与 Tick 的区块数量。

**内存压力**  
JVM 堆内存使用比例与 GC 停顿时间。

**玩家密度**  
玩家聚集程度与热点区域强度。

各权重系数（α β γ δ ε）可配置，
以适应不同服务器环境。

LoadScore 是整个自适应引擎的统一决策信号。

---

# 🧭 自适应状态引擎

根据 LoadScore，服务器进入不同运行状态：

| 状态 | 分数范围 | 行为 |
|------|----------|------|
| NORMAL | 0–25 | 不干预 |
| WATCH | 25–50 | 轻度节流 |
| STRESS | 50–75 | 实体调节 |
| CRITICAL | 75+ | 智能清理 |

系统采用滞后机制，避免频繁震荡。

---

# 🏗 系统架构

EcoServer 采用三层控制架构：

## 1️⃣ 感知层（Sensor Layer）
采集运行数据并计算 LoadScore。

## 2️⃣ 策略层（Strategy Layer）
根据 LoadScore 判断服务器状态。

## 3️⃣ 执行层（Executor Layer）
动态执行优化策略，例如：

- 智能掉落物清理
- 实体休眠系统
- 刷怪笼优化
- 动态视距控制（实验功能）

---

# 🧊 计划功能

- TPS 滑动平均监控
- 智能掉落物清理
- 实体生命周期管理
- JVM GC 监听（JMX）
- 玩家热力图优化
- Spark 性能分析联动

---

# 🛠 支持平台

- Paper（优先支持）
- Purpur
- Pufferfish

专为优化核心设计。

---

# 📅 开发路线

## v0.1 基础版本
- LoadScore 实现
- 状态控制器
- 智能清理
- `/eco health` 指令

## v0.2 自适应版本
- 实体休眠系统
- GC 监听
- 刷怪笼优化

## v0.3 预测版本
- 热力图系统
- 分世界规则引擎
- Spark 联动分析

## v1.0 稳定版本
- 大规模压力测试
- API 开放
- 稳定性验证

---

# 📄 许可证

MIT 许可证
