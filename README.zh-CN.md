# EcoServer
### 面向 Paper 服务器的自适应性能控制引擎

> EcoServer 不是清理插件  
> 它是一个用于高负载服务器的自适应性能控制系统

[English Version](README.md)

---

## 🚀 项目愿景

大多数优化插件在 TPS 已经下降之后才开始清理实体。

EcoServer 的目标不是“清理”，而是“控制”。

我们希望实现：

- 主动预测负载趋势
- 动态调节服务器行为
- 减少不可见的计算浪费
- 将优化对玩家的影响降到最低
- 保持插件自身极低性能开销

---

## 🧠 性能核心模型

EcoServer 的所有优化决策，都围绕一个统一性能指数展开：

### LoadScore

LoadScore 是 EcoServer 的核心性能评分模型。

它将多个运行时指标整合为一个统一负载评分，
用于驱动状态机与执行策略。

### 模型结构

LoadScore 综合以下指标：

- TPS 偏移
- 实体密度
- 区块活跃度
- 内存压力
- 玩家密度

### 概念公式

LoadScore = α(TPS 偏移)
+ β(实体密度)
+ γ(区块活跃度)
+ δ(内存压力)
+ ε(玩家密度)


### 指标说明

**TPS 偏移**  
表示当前 TPS 与理想 20 TPS 的差值，并结合滑动平均趋势。

**实体密度**  
根据实体类型加权统计总量（掉落物、生物、方块实体）。

**区块活跃度**  
统计当前加载且参与 Tick 的区块数量。

**内存压力**  
基于 JVM 堆内存使用比例与 GC 停顿时间。

**玩家密度**  
分析玩家聚集程度与热点区域分布。

各权重系数（α β γ δ ε）可在配置文件中调整。

LoadScore 是统一决策依据，而不是单一阈值触发机制。

---

## 🧭 自适应状态系统

根据 LoadScore，服务器进入不同运行状态：

| 状态 | 分数区间 | 行为 |
|------|----------|------|
| NORMAL | 0–25 | 不干预 |
| WATCH | 25–50 | 轻度节流 |
| STRESS | 50–75 | 实体调节 |
| CRITICAL | 75+ | 智能清理 |

系统采用滞后机制（Hysteresis）防止频繁震荡。

---

## 🏗 系统架构

EcoServer 采用三层控制架构：

### 1️⃣ 感知层（Sensor Layer）
采集运行指标并计算 LoadScore。

### 2️⃣ 策略层（Strategy Layer）
根据 LoadScore 判断服务器状态。

### 3️⃣ 执行层（Executor Layer）
动态执行优化策略，例如：

- 智能掉落物清理
- 实体休眠系统
- 刷怪笼优化
- 动态视距控制（实验功能）

---

## 🛠 支持平台

- Paper（优先支持）
- Purpur
- Pufferfish

专为优化核心设计。

---

## 📅 开发路线

### v0.1 基础版本
- LoadScore 实现
- 状态控制器
- 智能掉落物清理
- `/eco health` 指令

### v0.2 自适应版本
- 实体休眠系统
- JVM GC 监听
- 刷怪笼优化

### v0.3 预测版本
- 玩家热力图系统
- 分世界规则引擎
- Spark 联动分析

### v1.0 稳定版本
- 大规模压力测试
- API 开放
- 稳定性验证

---

## 🔬 项目定位

EcoServer 不是“卡顿清理插件”。

它的目标是构建：

> 服务器级自适应性能中间层。
